<form (ngSubmit)="createSupplierAccount()" [ngClass]="{ 'form--invalid': submitted }">
  <div class="container">
    <div class="row">
      <div class="col-10 offset-1 col-lg-8 offset-lg-2" @auth>

        <div class="sign-up-form__header">
          <div class="row">
            <div class="col-12">
              <a class="icon__link" routerLink="/signup/step2">
                <i-chevron-left class="text-dark icon--lg"></i-chevron-left>
              </a>
            </div>
          </div>
          <h1>Crear cuenta Proveedor</h1>
          <p>¡Bienvenido a la comunidad de Eprocurement! Por favor, complete la siguiente información para finalizar su
            registro con éxito. Tenga la seguridad que la información ingresada sólo se utilizará con fines de registrar y
            administrar su cuenta.</p>
        </div>

        <div class="sign-up-form__body">
          <div class="row">

            <div class="col-lg-6">
              <div class="form-group">
                <label>CUIT/CUIL</label>
                <input type="text" maxlength="11" class="form-control input__icon--user" placeholder="27000000001" readonly [value]="cuit">
              </div>
            </div>

            <div class="col-12">
              <hr class="divider">
              <h5>Datos de la cuenta</h5>
            </div>

            <div class="col-12">
              <div class="form-group">
                <label>Correo electrónico</label>
                <input type="email" class="form-control input__icon--mail" placeholder="usuario@mail.com"
                [formControl]="signUpSupplierForm.controls['email']">
                <div class="invalid-feedback" *ngIf="signUpSupplierForm.controls['email'].errors?.email">
                  Correo electrónico inválido.
                </div>
                <div class="invalid-feedback" *ngIf="signUpSupplierForm.controls['email'].errors?.required">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="form-group position-relative">
                <label>Contraseña</label>
                <input type="password" class="form-control input__icon--lock" id="exampleInputPassword1" placeholder="xxxxxxxx" [formControl]="signUpSupplierForm.controls['password']">
                <div class="input__detail">
                  La contraseña debe tener como mínimo 4 caracteres. Además, debe incluir al menos una letra y/o número.
                </div>
                <div class="invalid-feedback" *ngIf="this.signUpSupplierForm.controls['password'].errors?.minlength">
                  La contraseña debe incluir al menos 4 caracteres.
                </div>
                <div class="invalid-feedback" *ngIf="this.signUpSupplierForm.controls['password'].errors?.pattern">
                  La contraseña debe incluir al menos una letra y/o número.
                </div>
                <div class="invalid-feedback" *ngIf="this.signUpSupplierForm.controls['password'].errors?.valid">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="form-group">
                <label>Confirmación de contraseña</label>
                <input type="password" class="form-control input__icon--lock" placeholder="********"
                [formControl]="signUpSupplierForm.controls['passwordRepeat']">
                <div class="invalid-feedback" *ngIf="this.signUpSupplierForm.controls['passwordRepeat'].errors?.required">
                  El campo es requerido.
                </div>
                <div class="invalid-feedback" *ngIf="this.signUpSupplierForm.controls['passwordRepeat'].errors?.mustMatch">
                  La confirmación de contraseña no coincide.
                </div>
              </div>
            </div>

            <div class="col-12">
              <hr class="divider">
              <h5>Datos de la empresa</h5>
            </div>

            <div class="col-12">
              <div class="form-group">
                <label>Razón social</label>
                <input type="text" class="form-control" placeholder="Origin Software S.A."
                [formControl]="signUpSupplierForm.controls['businessName']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-4 col-lg-6">
              <div class="form-group">
                <label>Código de Área</label>
                <input type="" class="form-control" placeholder="011">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-8 col-lg-6">
              <div class="form-group">
                <label>Teléfono</label>
                <input type="tel" class="form-control" placeholder="4444-4444"
                [formControl]="signUpSupplierForm.controls['phone']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-lg-9">
              <div class="form-group">
                <label>Calle/Avenida</label>
                <input type="tex" class="form-control" placeholder="Avenida Álvarez Thomas"
                [formControl]="signUpSupplierForm.controls['street']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-6 col-lg-3">
              <div class="form-group">
                <label>Número</label>
                <input type="" class="form-control" placeholder="1131"
                [formControl]="signUpSupplierForm.controls['streetNumber']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-6 col-lg-6">
              <div class="form-group">
                <label>Piso/Depto<small> (opcional)</small></label>
                <input type="" class="form-control" placeholder="4 A/B"
                [formControl]="signUpSupplierForm.controls['apartment']">
              </div>
            </div>

            <div class="col-lg-6">
              <div class="form-group">
                <label>Código postal</label>
                <input type="" class="form-control" placeholder="1427"
                [formControl]="signUpSupplierForm.controls['postCode']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
                <div class="form-group">
                  <label for="SupplierssProvince">Provincia</label>
                  <select class="form-control input__icon--chevron-down" id="SupplierssProvince"
                    (change)="getData($event.target.value)" [formControl]="signUpSupplierForm.controls['province']">
                    <div class="invalid-feedback">
                      El campo es requerido.
                    </div>
                    <option selected hidden [ngValue]="null">Seleccionar Provincia</option>
                    <option [ngValue]="item.id" *ngFor="let item of provinces">{{item.name}}</option>
                  </select>
                </div>
              </div>

            <div class="col-lg-6">
              <div class="form-group">
                <label for="SuppliersLocality">Localidad</label>
                <select class="form-control input__icon--chevron-down" id="SuppliersLocality"
                  [formControl]="signUpSupplierForm.controls['locality']">
                  <div class="invalid-feedback">
                    El campo es requerido.
                  </div>
                  <option selected hidden [ngValue]="null">Seleccionar Localidad</option>
                  <option [ngValue]="item.id" *ngFor="let item of localities">{{item.name}}</option>
                </select>
              </div>
            </div>

            <div class="col-12">
              <hr class="divider">
              <h5>datos del responsable de la cuenta</h5>
            </div>

            <div class="col-lg-6">
              <div class="form-group">
                <label>Nombre</label>
                <input type="text" class="form-control" placeholder="Joe"
                [formControl]="signUpSupplierForm.controls['name']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="form-group">
                <label>Apellido</label>
                <input type="text" class="form-control" placeholder="Doe"
                [formControl]="signUpSupplierForm.controls['lastName']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-12">
              <div class="form-group">
                <label>Correo electrónico</label>
                <input type="email" class="form-control" placeholder="usuario@mail.com"
                [formControl]="signUpSupplierForm.controls['amEmail']">
                <div class="invalid-feedback" *ngIf="signUpSupplierForm.controls['email'].errors?.email">
                  Correo electrónico inválido.
                </div>
                <div class="invalid-feedback" *ngIf="signUpSupplierForm.controls['email'].errors?.required">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-4 col-lg-6">
                <div class="form-group">
                  <label>Código de Área</label>
                  <input type="text" class="form-control" placeholder="011"
                  [formControl]="signUpSupplierForm.controls['areaCode']">
                  <div class="invalid-feedback">
                    El campo es requerido.
                  </div>
                </div>
              </div>

            <div class="col-8 col-lg-6">
              <div class="form-group">
                <label>Teléfono</label>
                <input type="tel" class="form-control" placeholder="4444-4444"
                [formControl]="signUpSupplierForm.controls['amPhone']">
                <div class="invalid-feedback">
                  El campo es requerido.
                </div>
              </div>
            </div>

            <div class="col-12">
              <hr class="divider">
              <h5>Rubros y Subrubros en los que deseo participar</h5>
            </div>

            <div class="col-12" *ngIf="selectedCategories.length">
              <table class="table table--simple">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">Rubros</th>
                    <th scope="col">Subrubros</th>
                    <th scope="col">Acción</th>
                  </tr>
                </thead>
                <tbody>
                    <tr scope="row" *ngFor="let category of selectedCategories">
                      <td>{{category.name}}</td>
                      <td><div *ngFor="let subcategory of category.subcategories">{{subcategory.name}}</div></td>
                      <td><a class="text-danger" (click)="popCategory(category)">Quitar</a></td>
                    </tr>
                </tbody>
              </table>
            </div>

            <div class="col-12 d-flex justify-content-center">
              <button class="btn btn-outline-secondary" data-toggle="modal" data-target="#ModalSectors">
                Agregar rubros y subrubros
              </button>
            </div>

            <div class="col-12">
              <hr class="divider">
              <h5>Provincias en las que deseo participar</h5>
            </div>

            <div class="col-12" *ngIf="selectedProvinces.length">
              <div class="badges__container">
                <span class="badge badge-pill badge-secondary" *ngFor="let item of selectedProvinces">
                  <div>
                      {{item.name}}
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="popProvince(item)">
                        <span aria-hidden="true">&times;</span>
                      </button>
                  </div>
                </span>
              </div>
            </div>

            <div class="col-12 d-flex justify-content-center">
              <button class="btn btn-outline-secondary" data-toggle="modal" data-target="#ModalProvinces" (click)="getModalProvinces()">
                Agregar provincias
              </button>
            </div>

            <div class="col-12">
              <hr class="divider">
            </div>

            <div class="col-12">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="TermsConditionsCheck"
                [formControl]="signUpSupplierForm.controls['terms']">
                <label class="custom-control-label" for="TermsConditionsCheck">
                  Al hacer clic en Crear cuenta, estás aceptando los
                  <a href="#">Términos y Condiciones de Uso</a>
                  de Eprocurement.
                </label>
              </div>
            </div>

          </div>
        </div>

        <div class="sign-up-form__footer d-flex justify-content-center">
          <button type="submit" class="btn btn__primary--gradient" (click)="createSupplierAccount()">
            Crear cuenta proveedor</button>
          <button class="btn btn-outline-secondary" data-toggle="modal" data-target="#ModalCancel">Cancelar</button>
        </div>

      </div>
    </div>
  </div>
</form>

<!-- Position it -->
<div style="position: fixed; top: 1rem; right: 1rem;">

  <app-notifications></app-notifications>

</div>

<!-- Modal -->
<div class="modal fade" id="ModalSectors" tabindex="-1" role="dialog" aria-labelledby="ModalSectorsTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <div class="d-flex flex-column">
          <h1>Rubros y Subrubros</h1>
          <p>Seleccioná los ítems de tu interés para recibir notificaciones.</p>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="modal__card-item">
          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input" id="SectorAllCheck"
            (change)="$event.currentTarget.checked ? selectAll(true) : selectAll(false)">
            <label class="custom-control-label" for="SectorAllCheck">
              Seleccionar todos
            </label>
          </div>
        </div>
        <div class="modal__card" *ngFor="let category of categories; index as i">
          <div class="modal__card-header collapsed" data-toggle="collapse" [attr.data-target]="'#collapseSubitems'+i" role="button"
            aria-expanded="false" aria-controls="collapseSubitems1">
            <div class="custom-control custom-checkbox d-flex justify-content-between">
              <div>
                <input type="checkbox" class="custom-control-input" id="{{i}}" name="{{category.id}}"
                (change)="$event.currentTarget.checked ? selectAllCategory(category, true, i) : selectAllCategory(category, false, i)">
                <label class="custom-control-label" for="{{i}}">
                  {{category.name}}
                </label>
              </div>
              <i-chevron-down></i-chevron-down>
            </div>
          </div>
          <div class="collapse" id="collapseSubitems{{i}}" *ngFor="let subcategory of category.subcategories">
            <div class="card card-body">
              <div class="modal__card-subitem">
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="{{subcategory.id}}"
                  (change)="$event.currentTarget.checked ?
                  pushSubcategory(subcategory, category, i) : popSubcategory(subcategory, category, i)"
                  name="check-subcategory{{i}}">
                  <label class="custom-control-label" for="{{subcategory.id}}">
                    {{subcategory.name}}
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Aceptar</button>
        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancelar</button>
      </div>

    </div>
  </div>
</div>

<div class="modal fade" id="ModalProvinces" tabindex="-1" role="dialog" aria-labelledby="ModalProvincesTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-header">
        <div class="d-flex flex-column">
          <h1>Provincias</h1>
          <p>Seleccioná las provincias en las que desea participar para ofertar.</p>
        </div>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="modal__card-item">
          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input" id="ProvinceAllCheck"
            (change)="$event.currentTarget.checked ? selectAllProvinces(true) : selectAllProvinces(false)">
            <label class="custom-control-label" for="ProvinceAllCheck">
              Seleccionar todas
            </label>
          </div>
        </div>
        <div class="modal__card-item" *ngFor="let item of modalProvinces">
          <div class="modal__card-header">
            <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="{{item.name}}" name="check-province"
              (change)="$event.currentTarget.checked ? pushProvince(item) : popProvince(item)">
              <label class="custom-control-label" for="{{item.name}}">
                {{item.name}}
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Aceptar</button>
        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancelar</button>
      </div>

    </div>
  </div>
</div>

<app-modal-cancel></app-modal-cancel>
